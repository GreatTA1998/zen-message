var Xe=Object.defineProperty;var ge=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var ve=(n,e,l)=>e in n?Xe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[e]=l,be=(n,e)=>{for(var l in e||(e={}))$e.call(e,l)&&ve(n,l,e[l]);if(ge)for(var l of ge(e))xe.call(e,l)&&ve(n,l,e[l]);return n};import{S as He,i as Le,s as me,l as J,g as N,e as y,k as q,c as k,a as D,m as F,d as c,f as h,b as P,J as d,K as S,L as ie,t as M,h as V,M as le,N as B,O as se,P as oe,Q as et,R as tt,v as lt,T as Ze,U as G,V as $,W as he,E as st,X as ce,Y as Je,Z as ye,j as Y,o as x,p as pe,q as ee,_ as ke,$ as it,a0 as nt,a1 as ot,a2 as rt,n as _e,a3 as we,w as Ge,x as Ke,y as Qe,B as Ye}from"../chunks/vendor-f53b4472.js";import{d as Z,u as ue,h as De,P as at}from"../chunks/PhoneLogin-9d4641d4.js";import"../chunks/singletons-d1fb5791.js";const de=function(n,e={month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"utc"}){const l=new Date(n);let t=l.getTimezoneOffset()*6e4;return new Date(l-t).toLocaleDateString("en-US",e)};function Ie(n,e,l){const t=n.slice();return t[18]=e[l],t}function Ee(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function ze(n){let e,l=n[5].messages,t=[];for(let s=0;s<l.length;s+=1)t[s]=Ue(Ee(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=J()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=J()},m(s,o){for(let i=0;i<t.length;i+=1)t[i].m(s,o);N(s,e,o)},p(s,o){if(o&41){l=s[5].messages;let i;for(i=0;i<l.length;i+=1){const f=Ee(s,l,i);t[i]?t[i].p(f,o):(t[i]=Ue(f),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){ie(t,s),s&&c(e)}}}function ft(n){let e,l=n[21].content+"",t,s,o,i=" "+de(n[21].timestamp),f;return{c(){e=y("p"),t=M(l),s=q(),o=y("p"),f=M(i),this.h()},l(r){e=k(r,"P",{style:!0,class:!0});var a=D(e);t=V(a,l),a.forEach(c),s=F(r),o=k(r,"P",{style:!0,class:!0});var _=D(o);f=V(_,i),_.forEach(c),this.h()},h(){h(e,"margin-right","4px"),h(e,"margin-left","0"),h(e,"margin-bottom","4px"),P(e,"class","svelte-l9tbzz"),h(o,"font-size","0.8rem"),h(o,"color","grey"),h(o,"margin-left","0"),h(o,"margin-right","auto"),h(o,"margin-top","18px"),P(o,"class","svelte-l9tbzz")},m(r,a){N(r,e,a),d(e,t),N(r,s,a),N(r,o,a),d(o,f)},p(r,a){a&32&&l!==(l=r[21].content+"")&&Y(t,l),a&32&&i!==(i=" "+de(r[21].timestamp))&&Y(f,i)},d(r){r&&c(e),r&&c(s),r&&c(o)}}}function ut(n){let e,l=n[21].content+"",t,s,o,i=" "+de(n[21].timestamp),f;return{c(){e=y("p"),t=M(l),s=q(),o=y("p"),f=M(i),this.h()},l(r){e=k(r,"P",{style:!0,class:!0});var a=D(e);t=V(a,l),a.forEach(c),s=F(r),o=k(r,"P",{style:!0,class:!0});var _=D(o);f=V(_,i),_.forEach(c),this.h()},h(){h(e,"margin-left","auto"),h(e,"margin-right","0"),h(e,"margin-bottom","4px"),P(e,"class","svelte-l9tbzz"),h(o,"font-size","0.7rem"),h(o,"color","grey"),h(o,"margin-left","4px"),h(o,"margin-bottom","0px"),h(o,"margin-top","18px"),P(o,"class","svelte-l9tbzz")},m(r,a){N(r,e,a),d(e,t),N(r,s,a),N(r,o,a),d(o,f)},p(r,a){a&32&&l!==(l=r[21].content+"")&&Y(t,l),a&32&&i!==(i=" "+de(r[21].timestamp))&&Y(f,i)},d(r){r&&c(e),r&&c(s),r&&c(o)}}}function Ne(n){let e;return{c(){e=y("div"),this.h()},l(l){e=k(l,"DIV",{class:!0}),D(e).forEach(c),this.h()},h(){P(e,"class","svelte-l9tbzz")},m(l,t){N(l,e,t),n[10](e)},p:S,d(l){l&&c(e),n[10](null)}}}function Ue(n){let e,l,t;function s(r,a){return r[21].authorUID===r[0].uid?ut:ft}let o=s(n),i=o(n),f=n[23]===n[5].messages.length-1&&Ne(n);return{c(){e=y("div"),i.c(),l=q(),f&&f.c(),t=q(),this.h()},l(r){e=k(r,"DIV",{style:!0,class:!0});var a=D(e);i.l(a),l=F(a),f&&f.l(a),t=F(a),a.forEach(c),this.h()},h(){h(e,"display","flex"),h(e,"width","280px"),h(e,"margin-right","20px"),P(e,"class","svelte-l9tbzz")},m(r,a){N(r,e,a),i.m(e,null),d(e,l),f&&f.m(e,null),d(e,t)},p(r,a){o===(o=s(r))&&i?i.p(r,a):(i.d(1),i=o(r),i&&(i.c(),i.m(e,l))),r[23]===r[5].messages.length-1?f?f.p(r,a):(f=Ne(r),f.c(),f.m(e,t)):f&&(f.d(1),f=null)},d(r){r&&c(e),i.d(),f&&f.d()}}}function Re(n){let e,l=n[18]+"",t,s,o,i;function f(){return n[13](n[18])}return{c(){e=y("div"),t=M(l),s=q(),this.h()},l(r){e=k(r,"DIV",{class:!0,style:!0});var a=D(e);t=V(a,l),s=F(a),a.forEach(c),this.h()},h(){P(e,"class","clickable-option svelte-l9tbzz"),h(e,"margin-left","4px"),le(e,"highlighted-box",n[1]===n[18])},m(r,a){N(r,e,a),d(e,t),d(e,s),o||(i=B(e,"click",f),o=!0)},p(r,a){n=r,a&66&&le(e,"highlighted-box",n[1]===n[18])},d(r){r&&c(e),o=!1,i()}}}function ct(n){let e,l,t,s,o,i,f,r,a,_,p,R,b,E,g=n[5].messages&&ze(n),v=n[6],w=[];for(let I=0;I<v.length;I+=1)w[I]=Re(Ie(n,v,I));return{c(){e=y("div"),l=y("div"),g&&g.c(),t=q(),s=y("input"),o=q(),i=y("div"),f=y("div"),r=M("Want reply:"),a=q();for(let I=0;I<w.length;I+=1)w[I].c();_=q(),p=y("button"),R=M("Send message"),this.h()},l(I){e=k(I,"DIV",{style:!0,class:!0});var u=D(e);l=k(u,"DIV",{id:!0,style:!0,class:!0});var m=D(l);g&&g.l(m),m.forEach(c),t=F(u),s=k(u,"INPUT",{style:!0,placeholder:!0,class:!0}),o=F(u),i=k(u,"DIV",{style:!0,class:!0});var U=D(i);f=k(U,"DIV",{style:!0,class:!0});var A=D(f);r=V(A,"Want reply:"),A.forEach(c),a=F(U);for(let T=0;T<w.length;T+=1)w[T].l(U);U.forEach(c),_=F(u),p=k(u,"BUTTON",{style:!0,class:!0});var C=D(p);R=V(C,"Send message"),C.forEach(c),u.forEach(c),this.h()},h(){P(l,"id","chat-window"),h(l,"height","200px"),h(l,"overflow-y","auto"),h(l,"overflow-x","hidden"),P(l,"class","svelte-l9tbzz"),h(s,"width","300px"),h(s,"box-sizing","border-box"),P(s,"placeholder","Type message here..."),P(s,"class","svelte-l9tbzz"),h(f,"color","grey"),P(f,"class","svelte-l9tbzz"),h(i,"display","flex"),h(i,"margin-top","5px"),h(i,"align-items","center"),h(i,"flex-wrap","nowrap"),P(i,"class","svelte-l9tbzz"),h(p,"margin-top","12px"),h(p,"height","30px"),h(p,"width","300px"),P(p,"class","svelte-l9tbzz"),h(e,"width","300px"),P(e,"class","svelte-l9tbzz")},m(I,u){N(I,e,u),d(e,l),g&&g.m(l,null),d(e,t),d(e,s),se(s,n[4]),n[12](s),d(e,o),d(e,i),d(i,f),d(f,r),d(i,a);for(let m=0;m<w.length;m+=1)w[m].m(i,null);d(e,_),d(e,p),d(p,R),b||(E=[B(s,"input",n[11]),B(p,"click",n[7])],b=!0)},p(I,[u]){if(I[5].messages?g?g.p(I,u):(g=ze(I),g.c(),g.m(l,null)):g&&(g.d(1),g=null),u&16&&s.value!==I[4]&&se(s,I[4]),u&66){v=I[6];let m;for(m=0;m<v.length;m+=1){const U=Ie(I,v,m);w[m]?w[m].p(U,u):(w[m]=Re(U),w[m].c(),w[m].m(i,null))}for(;m<w.length;m+=1)w[m].d(1);w.length=v.length}},i:S,o:S,d(I){I&&c(e),g&&g.d(),n[12](null),ie(w,I),b=!1,oe(E)}}}function dt(n,e){if(e||(e=100),n){var l=document.createElement("input");l.style.position="absolute",l.style.top=n.offsetTop+7+"px",l.style.left=n.offsetLeft+"px",l.style.height=0,l.style.opacity=0,document.body.appendChild(l),l.focus(),setTimeout(function(){n.focus(),n.click(),document.body.removeChild(l)},e)}}function ht(n,e,l){let{friendUID:t}=e,{chatRoomID:s}=e,{currentUser:o}=e;const i=et(),f=tt(i,"sendTextMessage");let r,a,_,p=["now","today","any time"],R="any time",b={messages:[]};lt(()=>{Ze(G(Z,"chats",s),async u=>{if(console.log("Current data: ",u.data()),u.data()){l(5,b=u.data());const m=G(Z,"users",o.uid);$(m,{friendUIDsWithNewMessages:he(t)}),await st(),dt(r,300);const U=document.getElementById("chat-window");U.scrollTop=U.scrollHeight}})});async function E(){const u=G(Z,"chats",s);$(u,{messages:ce({content:_,timestamp:Date.now(),authorUID:o.uid})});const m=G(Z,"users",t);$(m,{friendUIDsWithNewMessages:ce(o.uid)});const U=await Je(m);switch(R){case"any time":break;case"now":console.log("sending text to ,",U.data().phoneNumber),f({content:`${o.name} wrote "${_}"`,toWho:U.data().phoneNumber})}l(4,_="")}function g(u){ye[u?"unshift":"push"](()=>{a=u,l(3,a)})}function v(){_=this.value,l(4,_)}function w(u){ye[u?"unshift":"push"](()=>{r=u,l(2,r)})}const I=u=>l(1,R=u);return n.$$set=u=>{"friendUID"in u&&l(8,t=u.friendUID),"chatRoomID"in u&&l(9,s=u.chatRoomID),"currentUser"in u&&l(0,o=u.currentUser)},n.$$.update=()=>{n.$$.dirty&2&&console.log("reply within =",R)},[o,R,r,a,_,b,p,E,t,s,g,v,w,I]}class pt extends He{constructor(e){super();Le(this,e,ht,ct,me,{friendUID:8,chatRoomID:9,currentUser:0})}}function Te(n,e,l){const t=n.slice();return t[34]=e[l],t}function Me(n,e,l){const t=n.slice();return t[37]=e[l],t}function Ve(n,e,l){const t=n.slice();return t[40]=e[l],t}function Ce(n,e,l){const t=n.slice();return t[43]=e[l],t}function _t(n){let e,l,t,s,o,i,f,r,a,_,p,R,b,E,g,v,w,I,u,m=n[2].peopleCategories instanceof Array&&qe(n),U=n[8]&&Oe(n),A=n[2].messageRequestNames instanceof Array&&Be(n);return{c(){e=y("div"),m&&m.c(),l=q(),t=y("h2"),s=M("Editable category"),o=q(),i=y("button"),f=M("New category"),r=q(),a=y("input"),_=q(),p=y("button"),R=M("Add person"),b=q(),U&&U.c(),E=q(),g=y("h2"),v=M("Outside Messages"),w=q(),A&&A.c(),this.h()},l(C){e=k(C,"DIV",{style:!0});var T=D(e);m&&m.l(T),l=F(T),t=k(T,"H2",{class:!0,style:!0});var L=D(t);s=V(L,"Editable category"),L.forEach(c),o=F(T),i=k(T,"BUTTON",{});var K=D(i);f=V(K,"New category"),K.forEach(c),r=F(T),a=k(T,"INPUT",{style:!0}),_=F(T),p=k(T,"BUTTON",{style:!0});var W=D(p);R=V(W,"Add person"),W.forEach(c),b=F(T),U&&U.l(T),E=F(T),g=k(T,"H2",{class:!0,style:!0});var j=D(g);v=V(j,"Outside Messages"),j.forEach(c),w=F(T),A&&A.l(T),T.forEach(c),this.h()},h(){P(t,"class","message-group-title svelte-zpsj5u"),h(t,"margin-top","50px"),h(a,"width","90px"),h(p,"margin-top","20px"),P(g,"class","message-group-title svelte-zpsj5u"),h(g,"margin-top","50px"),h(e,"width","100px")},m(C,T){N(C,e,T),m&&m.m(e,null),d(e,l),d(e,t),d(t,s),d(e,o),d(e,i),d(i,f),d(e,r),d(e,a),se(a,n[6]),d(e,_),d(e,p),d(p,R),d(e,b),U&&U.m(e,null),d(e,E),d(e,g),d(g,v),d(e,w),A&&A.m(e,null),I||(u=[B(i,"click",n[15]),B(a,"input",n[21]),B(p,"click",n[22])],I=!0)},p(C,T){C[2].peopleCategories instanceof Array?m?m.p(C,T):(m=qe(C),m.c(),m.m(e,l)):m&&(m.d(1),m=null),T[0]&64&&a.value!==C[6]&&se(a,C[6]),C[8]?U?U.p(C,T):(U=Oe(C),U.c(),U.m(e,E)):U&&(U.d(1),U=null),C[2].messageRequestNames instanceof Array?A?A.p(C,T):(A=Be(C),A.c(),A.m(e,null)):A&&(A.d(1),A=null)},i:S,o:S,d(C){C&&c(e),m&&m.d(),U&&U.d(),A&&A.d(),I=!1,oe(u)}}}function mt(n){let e,l,t,s,o,i,f,r,a,_,p,R,b,E,g,v,w,I,u,m,U,A,C,T,L,K;return L=new at({props:{canTakeInternationalNumbers:!0}}),{c(){e=y("div"),l=y("h4"),t=M("Zen Messenger"),s=q(),o=y("ul"),i=y("li"),f=y("b"),r=M("Fewer notifications:"),a=M(" messages won't ping you unless it requires immediate attention"),_=q(),p=y("li"),R=y("b"),b=M("Message summaries:"),E=M(" notifications are batched at regular times "),g=y("i"),v=M("and"),w=M(" before message deadlines"),I=q(),u=y("li"),m=y("b"),U=M("Fixed contact:"),A=M(" left-side panes are arranged by you, not by who messaged you most recently"),C=q(),T=y("div"),Ge(L.$$.fragment),this.h()},l(W){e=k(W,"DIV",{style:!0});var j=D(e);l=k(j,"H4",{style:!0});var re=D(l);t=V(re,"Zen Messenger"),re.forEach(c),s=F(j),o=k(j,"UL",{style:!0});var X=D(o);i=k(X,"LI",{});var ne=D(i);f=k(ne,"B",{});var ae=D(f);r=V(ae,"Fewer notifications:"),ae.forEach(c),a=V(ne," messages won't ping you unless it requires immediate attention"),ne.forEach(c),_=F(X),p=k(X,"LI",{});var z=D(p);R=k(z,"B",{});var O=D(R);b=V(O,"Message summaries:"),O.forEach(c),E=V(z," notifications are batched at regular times "),g=k(z,"I",{});var Q=D(g);v=V(Q,"and"),Q.forEach(c),w=V(z," before message deadlines"),z.forEach(c),I=F(X),u=k(X,"LI",{});var H=D(u);m=k(H,"B",{});var te=D(m);U=V(te,"Fixed contact:"),te.forEach(c),A=V(H," left-side panes are arranged by you, not by who messaged you most recently"),H.forEach(c),X.forEach(c),j.forEach(c),C=F(W),T=k(W,"DIV",{style:!0});var fe=D(T);Ke(L.$$.fragment,fe),fe.forEach(c),this.h()},h(){h(l,"margin-left","12px"),h(o,"padding-left","12px"),h(o,"font-size","0.8rem"),h(o,"list-style","none"),h(e,"font-family","Roboto, sans-serif"),h(e,"font-size","1.5rem"),h(e,"color","grey"),h(e,"margin-top","20px"),h(T,"width","350px")},m(W,j){N(W,e,j),d(e,l),d(l,t),d(e,s),d(e,o),d(o,i),d(i,f),d(f,r),d(i,a),d(o,_),d(o,p),d(p,R),d(R,b),d(p,E),d(p,g),d(g,v),d(p,w),d(o,I),d(o,u),d(u,m),d(m,U),d(u,A),N(W,C,j),N(W,T,j),Qe(L,T,null),K=!0},p:S,i(W){K||(ee(L.$$.fragment,W),K=!0)},o(W){x(L.$$.fragment,W),K=!1},d(W){W&&c(e),W&&c(C),W&&c(T),Ye(L)}}}function gt(n){let e,l;return{c(){e=y("div"),l=M("Fetching your data..."),this.h()},l(t){e=k(t,"DIV",{style:!0});var s=D(e);l=V(s,"Fetching your data..."),s.forEach(c),this.h()},h(){h(e,"margin-left","4px")},m(t,s){N(t,e,s),d(e,l)},p:S,i:S,o:S,d(t){t&&c(e)}}}function qe(n){let e,l=n[2].peopleCategories,t=[];for(let s=0;s<l.length;s+=1)t[s]=Ae(Ve(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=J()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=J()},m(s,o){for(let i=0;i<t.length;i+=1)t[i].m(s,o);N(s,e,o)},p(s,o){if(o[0]&65670){l=s[2].peopleCategories;let i;for(i=0;i<l.length;i+=1){const f=Ve(s,l,i);t[i]?t[i].p(f,o):(t[i]=Ae(f),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){ie(t,s),s&&c(e)}}}function Fe(n){let e,l,t=n[43].name+"",s,o,i;function f(){return n[18](n[43])}function r(...a){return n[19](n[43],...a)}return{c(){e=y("div"),l=y("span"),s=M(t),this.h()},l(a){e=k(a,"DIV",{draggable:!0,style:!0,class:!0});var _=D(e);l=k(_,"SPAN",{style:!0});var p=D(l);s=V(p,t),p.forEach(c),_.forEach(c),this.h()},h(){h(l,"margin-left","5px"),P(e,"draggable","true"),h(e,"border","solid orange"),h(e,"height","40px"),h(e,"display","flex"),h(e,"align-items","center"),P(e,"class","svelte-zpsj5u"),le(e,"highlighted-box",n[43].uid===n[1]),le(e,"highlighted-blue",n[7].includes(n[43].uid))},m(a,_){N(a,e,_),d(e,l),d(l,s),o||(i=[B(e,"click",f),B(e,"dragstart",r)],o=!0)},p(a,_){n=a,_[0]&4&&t!==(t=n[43].name+"")&&Y(s,t),_[0]&6&&le(e,"highlighted-box",n[43].uid===n[1]),_[0]&132&&le(e,"highlighted-blue",n[7].includes(n[43].uid))},d(a){a&&c(e),o=!1,oe(i)}}}function Ae(n){let e,l,t=n[40]+"",s,o,i,f,r;function a(...b){return n[17](n[40],...b)}let _=n[2].friends.filter(a),p=[];for(let b=0;b<_.length;b+=1)p[b]=Fe(Ce(n,_,b));function R(...b){return n[20](n[40],...b)}return{c(){e=y("div"),l=y("h2"),s=M(t),o=q();for(let b=0;b<p.length;b+=1)p[b].c();i=q(),this.h()},l(b){e=k(b,"DIV",{});var E=D(e);l=k(E,"H2",{class:!0});var g=D(l);s=V(g,t),g.forEach(c),o=F(E);for(let v=0;v<p.length;v+=1)p[v].l(E);i=F(E),E.forEach(c),this.h()},h(){P(l,"class","message-group-title svelte-zpsj5u")},m(b,E){N(b,e,E),d(e,l),d(l,s),d(e,o);for(let g=0;g<p.length;g+=1)p[g].m(e,null);d(e,i),f||(r=[B(e,"drop",R),B(e,"dragover",wt)],f=!0)},p(b,E){if(n=b,E[0]&4&&t!==(t=n[40]+"")&&Y(s,t),E[0]&134){_=n[2].friends.filter(a);let g;for(g=0;g<_.length;g+=1){const v=Ce(n,_,g);p[g]?p[g].p(v,E):(p[g]=Fe(v),p[g].c(),p[g].m(e,i))}for(;g<p.length;g+=1)p[g].d(1);p.length=_.length}},d(b){b&&c(e),ie(p,b),f=!1,oe(r)}}}function Oe(n){let e,l,t,s,o=n[10],i=[];for(let f=0;f<o.length;f+=1)i[f]=We(Me(n,o,f));return{c(){e=y("div"),l=M("Here are all accounts:"),t=q();for(let f=0;f<i.length;f+=1)i[f].c();s=J()},l(f){e=k(f,"DIV",{});var r=D(e);l=V(r,"Here are all accounts:"),r.forEach(c),t=F(f);for(let a=0;a<i.length;a+=1)i[a].l(f);s=J()},m(f,r){N(f,e,r),d(e,l),N(f,t,r);for(let a=0;a<i.length;a+=1)i[a].m(f,r);N(f,s,r)},p(f,r){if(r[0]&3076){o=f[10];let a;for(a=0;a<o.length;a+=1){const _=Me(f,o,a);i[a]?i[a].p(_,r):(i[a]=We(_),i[a].c(),i[a].m(s.parentNode,s))}for(;a<i.length;a+=1)i[a].d(1);i.length=o.length}},d(f){f&&c(e),f&&c(t),ie(i,f),f&&c(s)}}}function Pe(n){let e,l,t=n[37].name+"",s,o,i,f;function r(){return n[23](n[37])}return{c(){e=y("div"),l=y("button"),s=M(t),o=q(),this.h()},l(a){e=k(a,"DIV",{style:!0});var _=D(e);l=k(_,"BUTTON",{style:!0});var p=D(l);s=V(p,t),p.forEach(c),o=F(_),_.forEach(c),this.h()},h(){h(l,"margin-left","20px"),h(e,"margin-top","10px")},m(a,_){N(a,e,_),d(e,l),d(l,s),d(e,o),i||(f=B(l,"click",r),i=!0)},p(a,_){n=a},d(a){a&&c(e),i=!1,f()}}}function We(n){let e,l=n[37].uid!==n[2].uid&&Pe(n);return{c(){l&&l.c(),e=J()},l(t){l&&l.l(t),e=J()},m(t,s){l&&l.m(t,s),N(t,e,s)},p(t,s){t[37].uid!==t[2].uid?l?l.p(t,s):(l=Pe(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){l&&l.d(t),t&&c(e)}}}function Be(n){let e,l=n[2].messageRequestNames,t=[];for(let s=0;s<l.length;s+=1)t[s]=Se(Te(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=J()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=J()},m(s,o){for(let i=0;i<t.length;i+=1)t[i].m(s,o);N(s,e,o)},p(s,o){if(o[0]&8196){l=s[2].messageRequestNames;let i;for(i=0;i<l.length;i+=1){const f=Te(s,l,i);t[i]?t[i].p(f,o):(t[i]=Se(f),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){ie(t,s),s&&c(e)}}}function Se(n){let e,l=n[34]+"",t,s,o,i;function f(){return n[24](n[34])}return{c(){e=y("div"),t=M(l),s=q(),this.h()},l(r){e=k(r,"DIV",{style:!0});var a=D(e);t=V(a,l),s=F(a),a.forEach(c),this.h()},h(){h(e,"border","solid blue"),h(e,"height","40px"),h(e,"display","flex"),h(e,"align-items","center")},m(r,a){N(r,e,a),d(e,t),d(e,s),o||(i=B(e,"click",f),o=!0)},p(r,a){n=r,a[0]&4&&l!==(l=n[34]+"")&&Y(t,l)},d(r){r&&c(e),o=!1,i()}}}function vt(n){let e,l,t,s,o,i,f,r,a,_,p,R,b,E=n[2].uid+"",g,v,w,I;return{c(){e=y("div"),l=M("Click any chat on the left-side"),t=q(),s=y("input"),o=q(),i=y("button"),f=M("Update name"),r=q(),a=y("div"),_=M("Give this link to close friends & family so they can message you without a zen-message account:"),p=q(),R=y("a"),b=M("zen-message.com/"),g=M(E),this.h()},l(u){e=k(u,"DIV",{style:!0});var m=D(e);l=V(m,"Click any chat on the left-side"),m.forEach(c),t=F(u),s=k(u,"INPUT",{placeholder:!0}),o=F(u),i=k(u,"BUTTON",{});var U=D(i);f=V(U,"Update name"),U.forEach(c),r=F(u),a=k(u,"DIV",{style:!0});var A=D(a);_=V(A,"Give this link to close friends & family so they can message you without a zen-message account:"),A.forEach(c),p=F(u),R=k(u,"A",{style:!0,href:!0,target:!0});var C=D(R);b=V(C,"zen-message.com/"),g=V(C,E),C.forEach(c),this.h()},h(){h(e,"margin-top","5px"),h(e,"margin-bottom","12px"),P(s,"placeholder","John Apple"),h(a,"margin-top","10px"),h(R,"font-size","0.8rem"),h(R,"color","blue"),P(R,"href",v="https://zen-message.com/"+n[2].uid),P(R,"target","_blank")},m(u,m){N(u,e,m),d(e,l),N(u,t,m),N(u,s,m),se(s,n[3]),N(u,o,m),N(u,i,m),d(i,f),N(u,r,m),N(u,a,m),d(a,_),N(u,p,m),N(u,R,m),d(R,b),d(R,g),w||(I=[B(s,"input",n[26]),B(i,"click",n[12])],w=!0)},p(u,m){m[0]&8&&s.value!==u[3]&&se(s,u[3]),m[0]&4&&E!==(E=u[2].uid+"")&&Y(g,E),m[0]&4&&v!==(v="https://zen-message.com/"+u[2].uid)&&P(R,"href",v)},i:S,o:S,d(u){u&&c(e),u&&c(t),u&&c(s),u&&c(o),u&&c(i),u&&c(r),u&&c(a),u&&c(p),u&&c(R),w=!1,oe(I)}}}function bt(n){let e,l,t,s,o,i,f;return{c(){e=y("div"),l=M(n[4]),t=q(),s=y("button"),o=M("Resolve and delete")},l(r){e=k(r,"DIV",{});var a=D(e);l=V(a,n[4]),a.forEach(c),t=F(r),s=k(r,"BUTTON",{});var _=D(s);o=V(_,"Resolve and delete"),_.forEach(c)},m(r,a){N(r,e,a),d(e,l),N(r,t,a),N(r,s,a),d(s,o),i||(f=B(s,"click",n[25]),i=!0)},p(r,a){a[0]&16&&Y(l,r[4])},i:S,o:S,d(r){r&&c(e),r&&c(t),r&&c(s),i=!1,f()}}}function yt(n){let e=n[1],l,t,s=je(n);return{c(){s.c(),l=J()},l(o){s.l(o),l=J()},m(o,i){s.m(o,i),N(o,l,i),t=!0},p(o,i){i[0]&2&&me(e,e=o[1])?(_e(),x(s,1,1,S),pe(),s=je(o),s.c(),ee(s),s.m(l.parentNode,l)):s.p(o,i)},i(o){t||(ee(s),t=!0)},o(o){x(s),t=!1},d(o){o&&c(l),s.d(o)}}}function je(n){let e,l;return e=new pt({props:{chatRoomID:n[0],friendUID:n[1],otherPersonUID:n[1],currentUser:n[2]}}),{c(){Ge(e.$$.fragment)},l(t){Ke(e.$$.fragment,t)},m(t,s){Qe(e,t,s),l=!0},p(t,s){const o={};s[0]&1&&(o.chatRoomID=t[0]),s[0]&2&&(o.friendUID=t[1]),s[0]&2&&(o.otherPersonUID=t[1]),s[0]&4&&(o.currentUser=t[2]),e.$set(o)},i(t){l||(ee(e.$$.fragment,t),l=!0)},o(t){x(e.$$.fragment,t),l=!1},d(t){Ye(e,t)}}}function kt(n){let e,l,t,s,o,i,f,r,a;const _=[gt,mt,_t],p=[];function R(v,w){return v[9]?v[9]&&!v[2]?1:2:0}t=R(n),s=p[t]=_[t](n);const b=[yt,bt,vt],E=[];function g(v,w){return v[1]&&v[2]&&v[0]?0:v[5]?1:v[2]?2:-1}return~(f=g(n))&&(r=E[f]=b[f](n)),{c(){e=y("div"),l=y("div"),s.c(),o=q(),i=y("div"),r&&r.c(),this.h()},l(v){e=k(v,"DIV",{style:!0});var w=D(e);l=k(w,"DIV",{});var I=D(l);s.l(I),I.forEach(c),o=F(w),i=k(w,"DIV",{style:!0});var u=D(i);r&&r.l(u),u.forEach(c),w.forEach(c),this.h()},h(){h(i,"width","320px"),h(i,"margin-left","5px"),h(i,"margin-top","5px"),h(e,"display","flex"),h(e,"padding-left","0px"),h(e,"padding-right","0px")},m(v,w){N(v,e,w),d(e,l),p[t].m(l,null),d(e,o),d(e,i),~f&&E[f].m(i,null),a=!0},p(v,w){let I=t;t=R(v),t===I?p[t].p(v,w):(_e(),x(p[I],1,1,()=>{p[I]=null}),pe(),s=p[t],s?s.p(v,w):(s=p[t]=_[t](v),s.c()),ee(s,1),s.m(l,null));let u=f;f=g(v),f===u?~f&&E[f].p(v,w):(r&&(_e(),x(E[u],1,1,()=>{E[u]=null}),pe()),~f?(r=E[f],r?r.p(v,w):(r=E[f]=b[f](v),r.c()),ee(r,1),r.m(i,null)):r=null)},i(v){a||(ee(s),ee(r),a=!0)},o(v){x(s),x(r),a=!1},d(v){v&&c(e),p[t].d(),~f&&E[f].d()}}}function wt(n){n.preventDefault(),n.dataTransfer.dropEffect="move"}function Dt(n,e){n.dataTransfer.setData("text/plain",e)}function It(n,e,l){let t,s;ke(n,ue,z=>l(2,t=z)),ke(n,De,z=>l(9,s=z));let o="",i="",f=null,r="",a="",_="",p=[];const R=it();let b="",E=[],g=!1;const v=nt(Z,"users");ot(v).then(z=>{z.docs.forEach(O=>{E.push(be({uid:O.id},O.data()))})});async function w({name:z,uid:O}){for(const fe of t.friends)if(fe.uid===O){alert("You're already friends"),l(8,g=!1);return}const Q=G(Z,"users",t.uid);await $(Q,{friends:ce({name:z,uid:O,category:t.peopleCategories[0]})});const H=t.uid<O?t.uid+O:O+t.uid,te=G(Z,"chats",H);await we(te,{participantUIDs:[O,t.uid],messages:[]}),l(8,g=!1)}rt(R,async z=>{if(z){const O=G(Z,"users",z.uid),Q=await Je(O);if(Q.exists())ue.set(Q.data());else{const H={uid:z.uid,name:z.displayName||"John Apple",phoneNumber:z.phoneNumber,friends:[],peopleCategories:["Friends","Family"],friendUIDsWithNewMessages:[]};await we(G(Z,"users",z.uid),H),ue.set(H)}Ze(G(Z,"users",z.uid),H=>{ue.set(H.data()),t.friendUIDsWithNewMessages&&l(7,p=t.friendUIDsWithNewMessages)})}De.set(!0)});async function I(){await $(G(Z,"users",t.uid),{name:o}),l(3,o=""),alert("successfully updated")}function u(z){l(1,b=""),l(5,a=z),l(4,r=t.messageRequestObjects.filter(O=>O.senderName===z)[0].content)}function m(z){$(f,{messageRequestObjects:he({content:r,senderName:a}),messageRequestNames:he(a)}),l(5,a=""),l(4,r="")}function U(){_||alert("New category can't be blank"),$(f,{peopleCategories:ce(_)}),console.log("created new category"),l(6,_="")}async function A(z,O){z.preventDefault();const Q=z.dataTransfer.getData("text/plain"),H=[...t.friends];for(const te of H)if(te.uid===Q){te.category=O;break}await $(f,{friends:H})}const C=(z,O)=>O.category===z,T=z=>l(1,b=z.uid),L=(z,O)=>Dt(O,z.uid),K=(z,O)=>A(O,z);function W(){_=this.value,l(6,_)}const j=()=>l(8,g=!g),re=z=>w(z),X=z=>u(z),ne=()=>m();function ae(){o=this.value,l(3,o)}return n.$$.update=()=>{n.$$.dirty[0]&7&&b&&(l(0,i=t.uid<b?t.uid+b:b+t.uid),console.log("chatRoomID =",i)),n.$$.dirty[0]&4&&t&&(f=G(Z,"users",t.uid))},[i,b,t,o,r,a,_,p,g,s,E,w,I,u,m,U,A,C,T,L,K,W,j,re,X,ne,ae]}class Rt extends He{constructor(e){super();Le(this,e,It,kt,me,{},null,[-1,-1])}}export{Rt as default};
