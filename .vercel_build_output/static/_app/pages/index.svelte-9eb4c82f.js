var Ke=Object.defineProperty;var ge=Object.getOwnPropertySymbols;var Qe=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ve=(n,e,t)=>e in n?Ke(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,be=(n,e)=>{for(var t in e||(e={}))Qe.call(e,t)&&ve(n,t,e[t]);if(ge)for(var t of ge(e))Xe.call(e,t)&&ve(n,t,e[t]);return n};import{S as Se,i as He,s as pe,l as Z,g as z,e as w,k as U,c as I,a as N,m as M,d as c,f as p,b as C,J as h,K as Q,L as se,t as V,h as O,M as te,N as H,O as le,P as fe,Q as $e,R as xe,v as et,T as Fe,U as K,V as ee,W as ce,E as tt,X as re,Y as je,Z as ye,j as X,o as $,p as he,q as x,_ as lt,$ as st,a0 as it,a1 as nt,a2 as ot,n as de,a3 as ke,w as Ye,x as Je,y as Ze,B as Ge}from"../chunks/vendor-f53b4472.js";import{d as J,u as oe,P as rt}from"../chunks/PhoneLogin-5d69dbd4.js";import"../chunks/singletons-d1fb5791.js";const ae=function(n,e={month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"utc"}){const t=new Date(n);let l=t.getTimezoneOffset()*6e4;return new Date(t-l).toLocaleDateString("en-US",e)};function we(n,e,t){const l=n.slice();return l[18]=e[t],l}function Ie(n,e,t){const l=n.slice();return l[21]=e[t],l[23]=t,l}function De(n){let e,t=n[5].messages,l=[];for(let s=0;s<t.length;s+=1)l[s]=Ne(Ie(n,t,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Z()},l(s){for(let o=0;o<l.length;o+=1)l[o].l(s);e=Z()},m(s,o){for(let i=0;i<l.length;i+=1)l[i].m(s,o);z(s,e,o)},p(s,o){if(o&41){t=s[5].messages;let i;for(i=0;i<t.length;i+=1){const f=Ie(s,t,i);l[i]?l[i].p(f,o):(l[i]=Ne(f),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(s){se(l,s),s&&c(e)}}}function at(n){let e,t=n[21].content+"",l,s,o,i=" "+ae(n[21].timestamp),f;return{c(){e=w("p"),l=V(t),s=U(),o=w("p"),f=V(i),this.h()},l(r){e=I(r,"P",{style:!0,class:!0});var a=N(e);l=O(a,t),a.forEach(c),s=M(r),o=I(r,"P",{style:!0,class:!0});var m=N(o);f=O(m,i),m.forEach(c),this.h()},h(){p(e,"margin-right","4px"),p(e,"margin-left","0"),p(e,"margin-bottom","4px"),C(e,"class","svelte-l9tbzz"),p(o,"font-size","0.8rem"),p(o,"color","grey"),p(o,"margin-left","0"),p(o,"margin-right","auto"),p(o,"margin-top","18px"),C(o,"class","svelte-l9tbzz")},m(r,a){z(r,e,a),h(e,l),z(r,s,a),z(r,o,a),h(o,f)},p(r,a){a&32&&t!==(t=r[21].content+"")&&X(l,t),a&32&&i!==(i=" "+ae(r[21].timestamp))&&X(f,i)},d(r){r&&c(e),r&&c(s),r&&c(o)}}}function ft(n){let e,t=n[21].content+"",l,s,o,i=" "+ae(n[21].timestamp),f;return{c(){e=w("p"),l=V(t),s=U(),o=w("p"),f=V(i),this.h()},l(r){e=I(r,"P",{style:!0,class:!0});var a=N(e);l=O(a,t),a.forEach(c),s=M(r),o=I(r,"P",{style:!0,class:!0});var m=N(o);f=O(m,i),m.forEach(c),this.h()},h(){p(e,"margin-left","auto"),p(e,"margin-right","0"),p(e,"margin-bottom","4px"),C(e,"class","svelte-l9tbzz"),p(o,"font-size","0.7rem"),p(o,"color","grey"),p(o,"margin-left","4px"),p(o,"margin-bottom","0px"),p(o,"margin-top","18px"),C(o,"class","svelte-l9tbzz")},m(r,a){z(r,e,a),h(e,l),z(r,s,a),z(r,o,a),h(o,f)},p(r,a){a&32&&t!==(t=r[21].content+"")&&X(l,t),a&32&&i!==(i=" "+ae(r[21].timestamp))&&X(f,i)},d(r){r&&c(e),r&&c(s),r&&c(o)}}}function Ee(n){let e;return{c(){e=w("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),N(e).forEach(c),this.h()},h(){C(e,"class","svelte-l9tbzz")},m(t,l){z(t,e,l),n[10](e)},p:Q,d(t){t&&c(e),n[10](null)}}}function Ne(n){let e,t,l;function s(r,a){return r[21].authorUID===r[0].uid?ft:at}let o=s(n),i=o(n),f=n[23]===n[5].messages.length-1&&Ee(n);return{c(){e=w("div"),i.c(),t=U(),f&&f.c(),l=U(),this.h()},l(r){e=I(r,"DIV",{style:!0,class:!0});var a=N(e);i.l(a),t=M(a),f&&f.l(a),l=M(a),a.forEach(c),this.h()},h(){p(e,"display","flex"),p(e,"width","280px"),p(e,"margin-right","20px"),C(e,"class","svelte-l9tbzz")},m(r,a){z(r,e,a),i.m(e,null),h(e,t),f&&f.m(e,null),h(e,l)},p(r,a){o===(o=s(r))&&i?i.p(r,a):(i.d(1),i=o(r),i&&(i.c(),i.m(e,t))),r[23]===r[5].messages.length-1?f?f.p(r,a):(f=Ee(r),f.c(),f.m(e,l)):f&&(f.d(1),f=null)},d(r){r&&c(e),i.d(),f&&f.d()}}}function ze(n){let e,t=n[18]+"",l,s,o,i;function f(){return n[13](n[18])}return{c(){e=w("div"),l=V(t),s=U(),this.h()},l(r){e=I(r,"DIV",{class:!0,style:!0});var a=N(e);l=O(a,t),s=M(a),a.forEach(c),this.h()},h(){C(e,"class","clickable-option svelte-l9tbzz"),p(e,"margin-left","4px"),te(e,"highlighted-box",n[1]===n[18])},m(r,a){z(r,e,a),h(e,l),h(e,s),o||(i=H(e,"click",f),o=!0)},p(r,a){n=r,a&66&&te(e,"highlighted-box",n[1]===n[18])},d(r){r&&c(e),o=!1,i()}}}function ut(n){let e,t,l,s,o,i,f,r,a,m,b,k,P,R,D=n[5].messages&&De(n),v=n[6],y=[];for(let g=0;g<v.length;g+=1)y[g]=ze(we(n,v,g));return{c(){e=w("div"),t=w("div"),D&&D.c(),l=U(),s=w("input"),o=U(),i=w("div"),f=w("div"),r=V("Want reply:"),a=U();for(let g=0;g<y.length;g+=1)y[g].c();m=U(),b=w("button"),k=V("Send message"),this.h()},l(g){e=I(g,"DIV",{style:!0,class:!0});var u=N(e);t=I(u,"DIV",{style:!0,class:!0});var d=N(t);D&&D.l(d),d.forEach(c),l=M(u),s=I(u,"INPUT",{style:!0,placeholder:!0,class:!0}),o=M(u),i=I(u,"DIV",{style:!0,class:!0});var T=N(i);f=I(T,"DIV",{style:!0,class:!0});var F=N(f);r=O(F,"Want reply:"),F.forEach(c),a=M(T);for(let j=0;j<y.length;j+=1)y[j].l(T);T.forEach(c),m=M(u),b=I(u,"BUTTON",{style:!0,class:!0});var S=N(b);k=O(S,"Send message"),S.forEach(c),u.forEach(c),this.h()},h(){p(t,"height","200px"),p(t,"overflow-y","auto"),p(t,"overflow-x","hidden"),C(t,"class","svelte-l9tbzz"),p(s,"width","300px"),p(s,"box-sizing","border-box"),C(s,"placeholder","Type message here..."),C(s,"class","svelte-l9tbzz"),p(f,"color","grey"),C(f,"class","svelte-l9tbzz"),p(i,"display","flex"),p(i,"margin-top","5px"),p(i,"align-items","center"),p(i,"flex-wrap","nowrap"),C(i,"class","svelte-l9tbzz"),p(b,"margin-top","12px"),p(b,"height","30px"),p(b,"width","300px"),C(b,"class","svelte-l9tbzz"),p(e,"width","300px"),C(e,"class","svelte-l9tbzz")},m(g,u){z(g,e,u),h(e,t),D&&D.m(t,null),h(e,l),h(e,s),le(s,n[4]),n[12](s),h(e,o),h(e,i),h(i,f),h(f,r),h(i,a);for(let d=0;d<y.length;d+=1)y[d].m(i,null);h(e,m),h(e,b),h(b,k),P||(R=[H(s,"input",n[11]),H(b,"click",n[7])],P=!0)},p(g,[u]){if(g[5].messages?D?D.p(g,u):(D=De(g),D.c(),D.m(t,null)):D&&(D.d(1),D=null),u&16&&s.value!==g[4]&&le(s,g[4]),u&66){v=g[6];let d;for(d=0;d<v.length;d+=1){const T=we(g,v,d);y[d]?y[d].p(T,u):(y[d]=ze(T),y[d].c(),y[d].m(i,null))}for(;d<y.length;d+=1)y[d].d(1);y.length=v.length}},i:Q,o:Q,d(g){g&&c(e),D&&D.d(),n[12](null),se(y,g),P=!1,fe(R)}}}function ct(n,e){if(e||(e=100),n){var t=document.createElement("input");t.style.position="absolute",t.style.top=n.offsetTop+7+"px",t.style.left=n.offsetLeft+"px",t.style.height=0,t.style.opacity=0,document.body.appendChild(t),t.focus(),setTimeout(function(){n.focus(),n.click(),document.body.removeChild(t)},e)}}function ht(n,e,t){let{friendUID:l}=e,{chatRoomID:s}=e,{currentUser:o}=e;const i=$e(),f=xe(i,"sendTextMessage");let r,a,m,b=["now","today","any time"],k="any time",P={messages:[]};et(()=>{Fe(K(J,"chats",s),async u=>{if(console.log("Current data: ",u.data()),u.data()){t(5,P=u.data());const d=K(J,"users",o.uid);ee(d,{friendUIDsWithNewMessages:ce(s)}),await tt(),ct(r,300),a.scrollIntoView({block:"center",behavior:"smooth"})}})});async function R(){const u=K(J,"chats",s);ee(u,{messages:re({content:m,timestamp:Date.now(),authorUID:o.uid})});const d=K(J,"users",l);ee(d,{friendUIDsWithNewMessages:re(o.uid)});const T=await je(d);switch(k){case"any time":break;case"now":console.log("sending text to ,",T.data().phoneNumber),f({content:`${o.name} wrote "${m}"`,toWho:T.data().phoneNumber})}t(4,m="")}function D(u){ye[u?"unshift":"push"](()=>{a=u,t(3,a)})}function v(){m=this.value,t(4,m)}function y(u){ye[u?"unshift":"push"](()=>{r=u,t(2,r)})}const g=u=>t(1,k=u);return n.$$set=u=>{"friendUID"in u&&t(8,l=u.friendUID),"chatRoomID"in u&&t(9,s=u.chatRoomID),"currentUser"in u&&t(0,o=u.currentUser)},n.$$.update=()=>{n.$$.dirty&2&&console.log("reply within =",k)},[o,k,r,a,m,P,b,R,l,s,D,v,y,g]}class dt extends Se{constructor(e){super();He(this,e,ht,ut,pe,{friendUID:8,chatRoomID:9,currentUser:0})}}function Re(n,e,t){const l=n.slice();return l[31]=e[t],l}function Te(n,e,t){const l=n.slice();return l[34]=e[t],l}function Ue(n,e,t){const l=n.slice();return l[37]=e[t],l}function Me(n,e,t){const l=n.slice();return l[40]=e[t],l}function pt(n){let e,t,l,s,o,i,f,r,a,m,b,k,P,R,D,v,y,g,u,d,T,F,S,j,G=n[2].friends,q=[];for(let _=0;_<G.length;_+=1)q[_]=Ve(Me(n,G,_));let W=n[8]&&Oe(n),B=n[2].peopleCategories instanceof Array&&Pe(n),L=n[2].messageRequestNames instanceof Array&&We(n);return{c(){e=w("div"),t=w("div"),l=w("h2"),s=V("People"),o=U();for(let _=0;_<q.length;_+=1)q[_].c();i=U(),f=w("button"),r=V("Add person"),a=U(),W&&W.c(),m=U(),B&&B.c(),b=U(),k=w("h2"),P=V("Editable category"),R=U(),D=w("button"),v=V("New category"),y=U(),g=w("input"),u=U(),d=w("h2"),T=V("Outside Messages"),F=U(),L&&L.c(),this.h()},l(_){e=I(_,"DIV",{style:!0});var E=N(e);t=I(E,"DIV",{});var A=N(t);l=I(A,"H2",{class:!0});var Y=N(l);s=O(Y,"People"),Y.forEach(c),o=M(A);for(let ue=0;ue<q.length;ue+=1)q[ue].l(A);A.forEach(c),i=M(E),f=I(E,"BUTTON",{style:!0});var ie=N(f);r=O(ie,"Add person"),ie.forEach(c),a=M(E),W&&W.l(E),m=M(E),B&&B.l(E),b=M(E),k=I(E,"H2",{class:!0,style:!0});var ne=N(k);P=O(ne,"Editable category"),ne.forEach(c),R=M(E),D=I(E,"BUTTON",{});var me=N(D);v=O(me,"New category"),me.forEach(c),y=M(E),g=I(E,"INPUT",{style:!0}),u=M(E),d=I(E,"H2",{class:!0,style:!0});var _e=N(d);T=O(_e,"Outside Messages"),_e.forEach(c),F=M(E),L&&L.l(E),E.forEach(c),this.h()},h(){C(l,"class","message-group-title svelte-1637l9v"),p(f,"margin-top","20px"),C(k,"class","message-group-title svelte-1637l9v"),p(k,"margin-top","50px"),p(g,"width","90px"),C(d,"class","message-group-title svelte-1637l9v"),p(d,"margin-top","50px"),p(e,"width","100px")},m(_,E){z(_,e,E),h(e,t),h(t,l),h(l,s),h(t,o);for(let A=0;A<q.length;A+=1)q[A].m(t,null);h(e,i),h(e,f),h(f,r),h(e,a),W&&W.m(e,null),h(e,m),B&&B.m(e,null),h(e,b),h(e,k),h(k,P),h(e,R),h(e,D),h(D,v),h(e,y),h(e,g),le(g,n[6]),h(e,u),h(e,d),h(d,T),h(e,F),L&&L.m(e,null),S||(j=[H(t,"drop",n[17]),H(t,"dragover",kt),H(f,"click",n[18]),H(D,"click",n[14]),H(g,"input",n[20])],S=!0)},p(_,E){if(E[0]&134){G=_[2].friends;let A;for(A=0;A<G.length;A+=1){const Y=Me(_,G,A);q[A]?q[A].p(Y,E):(q[A]=Ve(Y),q[A].c(),q[A].m(t,null))}for(;A<q.length;A+=1)q[A].d(1);q.length=G.length}_[8]?W?W.p(_,E):(W=Oe(_),W.c(),W.m(e,m)):W&&(W.d(1),W=null),_[2].peopleCategories instanceof Array?B?B.p(_,E):(B=Pe(_),B.c(),B.m(e,b)):B&&(B.d(1),B=null),E[0]&64&&g.value!==_[6]&&le(g,_[6]),_[2].messageRequestNames instanceof Array?L?L.p(_,E):(L=We(_),L.c(),L.m(e,null)):L&&(L.d(1),L=null)},i:Q,o:Q,d(_){_&&c(e),se(q,_),W&&W.d(),B&&B.d(),L&&L.d(),S=!1,fe(j)}}}function mt(n){let e,t,l,s,o,i,f,r,a,m,b,k,P,R,D,v,y,g,u;return g=new rt({props:{canTakeInternationalNumbers:!0}}),{c(){e=w("div"),t=w("b"),l=V("What problem does this solve:"),s=V(`
          Everytime someone messages us, we get a notification IMMEDIATELY, regardless of whether the message is time-sensitive, or even important. 
          Even if you try to ignore it, visually they go to the top of our chat list; 
          if you visited Messenger for a specific purpose, the top message distractions will help you forget what you were doing.
          Multiply that by all the people you message across time, and it's a disaster.

          `),o=w("br"),i=w("br"),f=U(),r=w("b"),a=V("How this app differs"),m=U(),b=w("ol"),k=w("li"),P=V(`Messages have no notifications by default unless the other person specifies it's time-sensitive e.g. "Before today" / "This week"`),R=U(),D=w("li"),v=V("Left-side is organized intentionally - NOT by whoever messaged you most recently"),y=U(),Ye(g.$$.fragment),this.h()},l(d){e=I(d,"DIV",{style:!0});var T=N(e);t=I(T,"B",{});var F=N(t);l=O(F,"What problem does this solve:"),F.forEach(c),s=O(T,`
          Everytime someone messages us, we get a notification IMMEDIATELY, regardless of whether the message is time-sensitive, or even important. 
          Even if you try to ignore it, visually they go to the top of our chat list; 
          if you visited Messenger for a specific purpose, the top message distractions will help you forget what you were doing.
          Multiply that by all the people you message across time, and it's a disaster.

          `),o=I(T,"BR",{}),i=I(T,"BR",{}),f=M(T),r=I(T,"B",{});var S=N(r);a=O(S,"How this app differs"),S.forEach(c),m=M(T),b=I(T,"OL",{});var j=N(b);k=I(j,"LI",{});var G=N(k);P=O(G,`Messages have no notifications by default unless the other person specifies it's time-sensitive e.g. "Before today" / "This week"`),G.forEach(c),R=M(j),D=I(j,"LI",{});var q=N(D);v=O(q,"Left-side is organized intentionally - NOT by whoever messaged you most recently"),q.forEach(c),j.forEach(c),T.forEach(c),y=M(d),Je(g.$$.fragment,d),this.h()},h(){p(e,"font-family","Roboto, sans-serif"),p(e,"font-size","1.5rem"),p(e,"color","grey"),p(e,"margin-top","20px")},m(d,T){z(d,e,T),h(e,t),h(t,l),h(e,s),h(e,o),h(e,i),h(e,f),h(e,r),h(r,a),h(e,m),h(e,b),h(b,k),h(k,P),h(b,R),h(b,D),h(D,v),z(d,y,T),Ze(g,d,T),u=!0},p:Q,i(d){u||(x(g.$$.fragment,d),u=!0)},o(d){$(g.$$.fragment,d),u=!1},d(d){d&&c(e),d&&c(y),Ge(g,d)}}}function Ve(n){let e,t,l=n[40].name+"",s,o,i,f;function r(){return n[15](n[40])}return{c(){e=w("div"),t=w("span"),s=V(l),o=U(),this.h()},l(a){e=I(a,"DIV",{draggable:!0,style:!0,class:!0});var m=N(e);t=I(m,"SPAN",{style:!0,class:!0});var b=N(t);s=O(b,l),b.forEach(c),o=M(m),m.forEach(c),this.h()},h(){p(t,"margin-left","5px"),C(t,"class","svelte-1637l9v"),C(e,"draggable","true"),p(e,"border","solid orange"),p(e,"height","40px"),p(e,"display","flex"),p(e,"align-items","center"),C(e,"class","svelte-1637l9v"),te(e,"highlighted-box",n[40].uid===n[1]),te(e,"highlighted-blue",n[7].includes(n[40].uid))},m(a,m){z(a,e,m),h(e,t),h(t,s),h(e,o),i||(f=[H(e,"click",r),H(e,"dragstart",n[16])],i=!0)},p(a,m){n=a,m[0]&4&&l!==(l=n[40].name+"")&&X(s,l),m[0]&6&&te(e,"highlighted-box",n[40].uid===n[1]),m[0]&132&&te(e,"highlighted-blue",n[7].includes(n[40].uid))},d(a){a&&c(e),i=!1,fe(f)}}}function Oe(n){let e,t,l,s,o=n[9],i=[];for(let f=0;f<o.length;f+=1)i[f]=Ce(Ue(n,o,f));return{c(){e=w("div"),t=V("Here are all accounts:"),l=U();for(let f=0;f<i.length;f+=1)i[f].c();s=Z()},l(f){e=I(f,"DIV",{});var r=N(e);t=O(r,"Here are all accounts:"),r.forEach(c),l=M(f);for(let a=0;a<i.length;a+=1)i[a].l(f);s=Z()},m(f,r){z(f,e,r),h(e,t),z(f,l,r);for(let a=0;a<i.length;a+=1)i[a].m(f,r);z(f,s,r)},p(f,r){if(r[0]&1540){o=f[9];let a;for(a=0;a<o.length;a+=1){const m=Ue(f,o,a);i[a]?i[a].p(m,r):(i[a]=Ce(m),i[a].c(),i[a].m(s.parentNode,s))}for(;a<i.length;a+=1)i[a].d(1);i.length=o.length}},d(f){f&&c(e),f&&c(l),se(i,f),f&&c(s)}}}function Ae(n){let e,t,l=n[37].name+"",s,o,i,f;function r(){return n[19](n[37])}return{c(){e=w("div"),t=w("button"),s=V(l),o=U(),this.h()},l(a){e=I(a,"DIV",{style:!0});var m=N(e);t=I(m,"BUTTON",{style:!0});var b=N(t);s=O(b,l),b.forEach(c),o=M(m),m.forEach(c),this.h()},h(){p(t,"margin-left","20px"),p(e,"margin-top","10px")},m(a,m){z(a,e,m),h(e,t),h(t,s),h(e,o),i||(f=H(t,"click",r),i=!0)},p(a,m){n=a},d(a){a&&c(e),i=!1,f()}}}function Ce(n){let e,t=n[37].uid!==n[2].uid&&Ae(n);return{c(){t&&t.c(),e=Z()},l(l){t&&t.l(l),e=Z()},m(l,s){t&&t.m(l,s),z(l,e,s)},p(l,s){l[37].uid!==l[2].uid?t?t.p(l,s):(t=Ae(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&c(e)}}}function Pe(n){let e,t=n[2].peopleCategories,l=[];for(let s=0;s<t.length;s+=1)l[s]=qe(Te(n,t,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Z()},l(s){for(let o=0;o<l.length;o+=1)l[o].l(s);e=Z()},m(s,o){for(let i=0;i<l.length;i+=1)l[i].m(s,o);z(s,e,o)},p(s,o){if(o[0]&4){t=s[2].peopleCategories;let i;for(i=0;i<t.length;i+=1){const f=Te(s,t,i);l[i]?l[i].p(f,o):(l[i]=qe(f),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(s){se(l,s),s&&c(e)}}}function qe(n){let e,t=n[34]+"",l;return{c(){e=w("h2"),l=V(t),this.h()},l(s){e=I(s,"H2",{class:!0});var o=N(e);l=O(o,t),o.forEach(c),this.h()},h(){C(e,"class","message-group-title svelte-1637l9v")},m(s,o){z(s,e,o),h(e,l)},p(s,o){o[0]&4&&t!==(t=s[34]+"")&&X(l,t)},d(s){s&&c(e)}}}function We(n){let e,t=n[2].messageRequestNames,l=[];for(let s=0;s<t.length;s+=1)l[s]=Be(Re(n,t,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Z()},l(s){for(let o=0;o<l.length;o+=1)l[o].l(s);e=Z()},m(s,o){for(let i=0;i<l.length;i+=1)l[i].m(s,o);z(s,e,o)},p(s,o){if(o[0]&4100){t=s[2].messageRequestNames;let i;for(i=0;i<t.length;i+=1){const f=Re(s,t,i);l[i]?l[i].p(f,o):(l[i]=Be(f),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(s){se(l,s),s&&c(e)}}}function Be(n){let e,t=n[31]+"",l,s,o,i;function f(){return n[21](n[31])}return{c(){e=w("div"),l=V(t),s=U(),this.h()},l(r){e=I(r,"DIV",{style:!0});var a=N(e);l=O(a,t),s=M(a),a.forEach(c),this.h()},h(){p(e,"border","solid blue"),p(e,"height","40px"),p(e,"display","flex"),p(e,"align-items","center")},m(r,a){z(r,e,a),h(e,l),h(e,s),o||(i=H(e,"click",f),o=!0)},p(r,a){n=r,a[0]&4&&t!==(t=n[31]+"")&&X(l,t)},d(r){r&&c(e),o=!1,i()}}}function _t(n){let e,t,l,s,o,i,f,r,a,m,b,k,P,R=n[2].uid+"",D,v,y,g;return{c(){e=w("div"),t=V("Click any chat on the left-side"),l=U(),s=w("input"),o=U(),i=w("button"),f=V("Update name"),r=U(),a=w("div"),m=V("Give this link to your friends & family so they can message you without a zen-message account:"),b=U(),k=w("a"),P=V("zen-message.com/"),D=V(R),this.h()},l(u){e=I(u,"DIV",{style:!0});var d=N(e);t=O(d,"Click any chat on the left-side"),d.forEach(c),l=M(u),s=I(u,"INPUT",{placeholder:!0}),o=M(u),i=I(u,"BUTTON",{});var T=N(i);f=O(T,"Update name"),T.forEach(c),r=M(u),a=I(u,"DIV",{style:!0});var F=N(a);m=O(F,"Give this link to your friends & family so they can message you without a zen-message account:"),F.forEach(c),b=M(u),k=I(u,"A",{style:!0,href:!0,target:!0});var S=N(k);P=O(S,"zen-message.com/"),D=O(S,R),S.forEach(c),this.h()},h(){p(e,"margin-top","5px"),p(e,"margin-bottom","12px"),C(s,"placeholder","John Apple"),p(a,"margin-top","10px"),p(k,"font-size","0.8rem"),p(k,"color","blue"),C(k,"href",v="https://zen-message.com/"+n[2].uid),C(k,"target","_blank")},m(u,d){z(u,e,d),h(e,t),z(u,l,d),z(u,s,d),le(s,n[3]),z(u,o,d),z(u,i,d),h(i,f),z(u,r,d),z(u,a,d),h(a,m),z(u,b,d),z(u,k,d),h(k,P),h(k,D),y||(g=[H(s,"input",n[23]),H(i,"click",n[11])],y=!0)},p(u,d){d[0]&8&&s.value!==u[3]&&le(s,u[3]),d[0]&4&&R!==(R=u[2].uid+"")&&X(D,R),d[0]&4&&v!==(v="https://zen-message.com/"+u[2].uid)&&C(k,"href",v)},i:Q,o:Q,d(u){u&&c(e),u&&c(l),u&&c(s),u&&c(o),u&&c(i),u&&c(r),u&&c(a),u&&c(b),u&&c(k),y=!1,fe(g)}}}function gt(n){let e,t,l,s,o,i,f;return{c(){e=w("div"),t=V(n[4]),l=U(),s=w("button"),o=V("Resolve and delete")},l(r){e=I(r,"DIV",{});var a=N(e);t=O(a,n[4]),a.forEach(c),l=M(r),s=I(r,"BUTTON",{});var m=N(s);o=O(m,"Resolve and delete"),m.forEach(c)},m(r,a){z(r,e,a),h(e,t),z(r,l,a),z(r,s,a),h(s,o),i||(f=H(s,"click",n[22]),i=!0)},p(r,a){a[0]&16&&X(t,r[4])},i:Q,o:Q,d(r){r&&c(e),r&&c(l),r&&c(s),i=!1,f()}}}function vt(n){let e=n[1],t,l,s=Le(n);return{c(){s.c(),t=Z()},l(o){s.l(o),t=Z()},m(o,i){s.m(o,i),z(o,t,i),l=!0},p(o,i){i[0]&2&&pe(e,e=o[1])?(de(),$(s,1,1,Q),he(),s=Le(o),s.c(),x(s),s.m(t.parentNode,t)):s.p(o,i)},i(o){l||(x(s),l=!0)},o(o){$(s),l=!1},d(o){o&&c(t),s.d(o)}}}function Le(n){let e,t;return e=new dt({props:{chatRoomID:n[0],friendUID:n[1],otherPersonUID:n[1],currentUser:n[2]}}),{c(){Ye(e.$$.fragment)},l(l){Je(e.$$.fragment,l)},m(l,s){Ze(e,l,s),t=!0},p(l,s){const o={};s[0]&1&&(o.chatRoomID=l[0]),s[0]&2&&(o.friendUID=l[1]),s[0]&2&&(o.otherPersonUID=l[1]),s[0]&4&&(o.currentUser=l[2]),e.$set(o)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){$(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function bt(n){let e,t,l,s,o,i,f,r,a;const m=[mt,pt],b=[];function k(v,y){return v[2]?1:0}l=k(n),s=b[l]=m[l](n);const P=[vt,gt,_t],R=[];function D(v,y){return v[1]&&v[2]&&v[0]?0:v[5]?1:v[2]?2:-1}return~(f=D(n))&&(r=R[f]=P[f](n)),{c(){e=w("div"),t=w("div"),s.c(),o=U(),i=w("div"),r&&r.c(),this.h()},l(v){e=I(v,"DIV",{style:!0});var y=N(e);t=I(y,"DIV",{});var g=N(t);s.l(g),g.forEach(c),o=M(y),i=I(y,"DIV",{style:!0});var u=N(i);r&&r.l(u),u.forEach(c),y.forEach(c),this.h()},h(){p(i,"width","320px"),p(i,"margin-left","5px"),p(i,"margin-top","5px"),p(e,"display","flex"),p(e,"padding-left","0px"),p(e,"padding-right","0px")},m(v,y){z(v,e,y),h(e,t),b[l].m(t,null),h(e,o),h(e,i),~f&&R[f].m(i,null),a=!0},p(v,y){let g=l;l=k(v),l===g?b[l].p(v,y):(de(),$(b[g],1,1,()=>{b[g]=null}),he(),s=b[l],s?s.p(v,y):(s=b[l]=m[l](v),s.c()),x(s,1),s.m(t,null));let u=f;f=D(v),f===u?~f&&R[f].p(v,y):(r&&(de(),$(R[u],1,1,()=>{R[u]=null}),he()),~f?(r=R[f],r?r.p(v,y):(r=R[f]=P[f](v),r.c()),x(r,1),r.m(i,null)):r=null)},i(v){a||(x(s),x(r),a=!0)},o(v){$(s),$(r),a=!1},d(v){v&&c(e),b[l].d(),~f&&R[f].d()}}}function yt(n){console.log("detected drop =",n)}function kt(n){console.log("detected dragover =",n)}function wt(n){console.log("dragstart =",n)}function It(n,e,t){let l;lt(n,oe,_=>t(2,l=_));let s="",o="",i=null,f="",r="",a="",m=[];const b=st();let k="",P=[],R=!1;const D=it(J,"users");nt(D).then(_=>{_.docs.forEach(E=>{P.push(be({uid:E.id},E.data()))})});async function v({name:_,uid:E}){for(const ne of l.friends)if(ne.uid===E){alert("You're already friends"),t(8,R=!1);return}const A=K(J,"users",l.uid);await ee(A,{friends:re({name:_,uid:E})});const Y=l.uid<E?l.uid+E:E+l.uid,ie=K(J,"chats",Y);await ke(ie,{participantUIDs:[E,l.uid],messages:[]}),t(8,R=!1)}ot(b,async _=>{if(_){const E=K(J,"users",_.uid),A=await je(E);if(A.exists())oe.set(A.data());else{const Y={uid:_.uid,name:_.displayName||"John Apple",phoneNumber:_.phoneNumber,friends:[],family:[],VIPs:[],everyoneElse:[]};await ke(K(J,"users",_.uid),Y),oe.set(Y)}Fe(K(J,"users",_.uid),Y=>{oe.set(Y.data()),l.friendUIDsWithNewMessages&&t(7,m=l.friendUIDsWithNewMessages)})}});async function y(){await ee(K(J,"users",l.uid),{name:s}),t(3,s=""),alert("successfully updated")}function g(_){t(1,k=""),t(5,r=_),t(4,f=l.messageRequestObjects.filter(E=>E.senderName===_)[0].content)}function u(_){ee(i,{messageRequestObjects:ce({content:f,senderName:r}),messageRequestNames:ce(r)}),t(5,r=""),t(4,f="")}function d(){a||alert("New category can't be blank"),ee(i,{peopleCategories:re(a)}),console.log("created new category"),t(6,a="")}const T=_=>t(1,k=_.uid),F=_=>wt(_),S=_=>yt(_),j=()=>t(8,R=!R),G=_=>v(_);function q(){a=this.value,t(6,a)}const W=_=>g(_),B=()=>u();function L(){s=this.value,t(3,s)}return n.$$.update=()=>{n.$$.dirty[0]&7&&k&&(t(0,o=l.uid<k?l.uid+k:k+l.uid),console.log("chatRoomID =",o)),n.$$.dirty[0]&4&&l&&(i=K(J,"users",l.uid))},[o,k,l,s,f,r,a,m,R,P,v,y,g,u,d,T,F,S,j,G,q,W,B,L]}class Rt extends Se{constructor(e){super();He(this,e,It,bt,pe,{},null,[-1,-1])}}export{Rt as default};
