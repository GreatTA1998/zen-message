var Xe=Object.defineProperty;var ge=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var ve=(n,e,l)=>e in n?Xe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[e]=l,be=(n,e)=>{for(var l in e||(e={}))$e.call(e,l)&&ve(n,l,e[l]);if(ge)for(var l of ge(e))xe.call(e,l)&&ve(n,l,e[l]);return n};import{S as He,i as Ze,s as me,l as J,g as z,e as y,k as q,c as k,a as w,m as F,d as c,f as h,b as P,J as d,K as S,L as ie,t as V,h as M,M as le,N as B,O as se,P as oe,Q as et,R as tt,v as lt,T as je,U as G,V as $,W as he,E as st,X as ce,Y as Je,Z as ye,j as Y,o as x,p as _e,q as ee,_ as ke,$ as it,a0 as nt,a1 as ot,a2 as rt,n as pe,a3 as De,w as Ge,x as Ke,y as Qe,B as Ye}from"../chunks/vendor-f53b4472.js";import{d as j,u as ue,h as we,P as at}from"../chunks/PhoneLogin-9d4641d4.js";import"../chunks/singletons-d1fb5791.js";const de=function(n,e={month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"utc"}){const l=new Date(n);let t=l.getTimezoneOffset()*6e4;return new Date(l-t).toLocaleDateString("en-US",e)};function Ie(n,e,l){const t=n.slice();return t[18]=e[l],t}function Ee(n,e,l){const t=n.slice();return t[21]=e[l],t[23]=l,t}function Ne(n){let e,l=n[5].messages,t=[];for(let s=0;s<l.length;s+=1)t[s]=Ue(Ee(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=J()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=J()},m(s,o){for(let i=0;i<t.length;i+=1)t[i].m(s,o);z(s,e,o)},p(s,o){if(o&41){l=s[5].messages;let i;for(i=0;i<l.length;i+=1){const f=Ee(s,l,i);t[i]?t[i].p(f,o):(t[i]=Ue(f),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){ie(t,s),s&&c(e)}}}function ft(n){let e,l=n[21].content+"",t,s,o,i=" "+de(n[21].timestamp),f;return{c(){e=y("p"),t=V(l),s=q(),o=y("p"),f=V(i),this.h()},l(a){e=k(a,"P",{style:!0,class:!0});var r=w(e);t=M(r,l),r.forEach(c),s=F(a),o=k(a,"P",{style:!0,class:!0});var p=w(o);f=M(p,i),p.forEach(c),this.h()},h(){h(e,"margin-right","4px"),h(e,"margin-left","0"),h(e,"margin-bottom","4px"),P(e,"class","svelte-l9tbzz"),h(o,"font-size","0.8rem"),h(o,"color","grey"),h(o,"margin-left","0"),h(o,"margin-right","auto"),h(o,"margin-top","18px"),P(o,"class","svelte-l9tbzz")},m(a,r){z(a,e,r),d(e,t),z(a,s,r),z(a,o,r),d(o,f)},p(a,r){r&32&&l!==(l=a[21].content+"")&&Y(t,l),r&32&&i!==(i=" "+de(a[21].timestamp))&&Y(f,i)},d(a){a&&c(e),a&&c(s),a&&c(o)}}}function ut(n){let e,l=n[21].content+"",t,s,o,i=" "+de(n[21].timestamp),f;return{c(){e=y("p"),t=V(l),s=q(),o=y("p"),f=V(i),this.h()},l(a){e=k(a,"P",{style:!0,class:!0});var r=w(e);t=M(r,l),r.forEach(c),s=F(a),o=k(a,"P",{style:!0,class:!0});var p=w(o);f=M(p,i),p.forEach(c),this.h()},h(){h(e,"margin-left","auto"),h(e,"margin-right","0"),h(e,"margin-bottom","4px"),P(e,"class","svelte-l9tbzz"),h(o,"font-size","0.7rem"),h(o,"color","grey"),h(o,"margin-left","4px"),h(o,"margin-bottom","0px"),h(o,"margin-top","18px"),P(o,"class","svelte-l9tbzz")},m(a,r){z(a,e,r),d(e,t),z(a,s,r),z(a,o,r),d(o,f)},p(a,r){r&32&&l!==(l=a[21].content+"")&&Y(t,l),r&32&&i!==(i=" "+de(a[21].timestamp))&&Y(f,i)},d(a){a&&c(e),a&&c(s),a&&c(o)}}}function ze(n){let e;return{c(){e=y("div"),this.h()},l(l){e=k(l,"DIV",{class:!0}),w(e).forEach(c),this.h()},h(){P(e,"class","svelte-l9tbzz")},m(l,t){z(l,e,t),n[10](e)},p:S,d(l){l&&c(e),n[10](null)}}}function Ue(n){let e,l,t;function s(a,r){return a[21].authorUID===a[0].uid?ut:ft}let o=s(n),i=o(n),f=n[23]===n[5].messages.length-1&&ze(n);return{c(){e=y("div"),i.c(),l=q(),f&&f.c(),t=q(),this.h()},l(a){e=k(a,"DIV",{style:!0,class:!0});var r=w(e);i.l(r),l=F(r),f&&f.l(r),t=F(r),r.forEach(c),this.h()},h(){h(e,"display","flex"),h(e,"width","280px"),h(e,"margin-right","20px"),P(e,"class","svelte-l9tbzz")},m(a,r){z(a,e,r),i.m(e,null),d(e,l),f&&f.m(e,null),d(e,t)},p(a,r){o===(o=s(a))&&i?i.p(a,r):(i.d(1),i=o(a),i&&(i.c(),i.m(e,l))),a[23]===a[5].messages.length-1?f?f.p(a,r):(f=ze(a),f.c(),f.m(e,t)):f&&(f.d(1),f=null)},d(a){a&&c(e),i.d(),f&&f.d()}}}function Re(n){let e,l=n[18]+"",t,s,o,i;function f(){return n[13](n[18])}return{c(){e=y("div"),t=V(l),s=q(),this.h()},l(a){e=k(a,"DIV",{class:!0,style:!0});var r=w(e);t=M(r,l),s=F(r),r.forEach(c),this.h()},h(){P(e,"class","clickable-option svelte-l9tbzz"),h(e,"margin-left","4px"),le(e,"highlighted-box",n[1]===n[18])},m(a,r){z(a,e,r),d(e,t),d(e,s),o||(i=B(e,"click",f),o=!0)},p(a,r){n=a,r&66&&le(e,"highlighted-box",n[1]===n[18])},d(a){a&&c(e),o=!1,i()}}}function ct(n){let e,l,t,s,o,i,f,a,r,p,_,U,b,E,g=n[5].messages&&Ne(n),v=n[6],D=[];for(let I=0;I<v.length;I+=1)D[I]=Re(Ie(n,v,I));return{c(){e=y("div"),l=y("div"),g&&g.c(),t=q(),s=y("input"),o=q(),i=y("div"),f=y("div"),a=V("Want reply:"),r=q();for(let I=0;I<D.length;I+=1)D[I].c();p=q(),_=y("button"),U=V("Send message"),this.h()},l(I){e=k(I,"DIV",{style:!0,class:!0});var u=w(e);l=k(u,"DIV",{style:!0,class:!0});var m=w(l);g&&g.l(m),m.forEach(c),t=F(u),s=k(u,"INPUT",{style:!0,placeholder:!0,class:!0}),o=F(u),i=k(u,"DIV",{style:!0,class:!0});var T=w(i);f=k(T,"DIV",{style:!0,class:!0});var A=w(f);a=M(A,"Want reply:"),A.forEach(c),r=F(T);for(let R=0;R<D.length;R+=1)D[R].l(T);T.forEach(c),p=F(u),_=k(u,"BUTTON",{style:!0,class:!0});var C=w(_);U=M(C,"Send message"),C.forEach(c),u.forEach(c),this.h()},h(){h(l,"height","200px"),h(l,"overflow-y","auto"),h(l,"overflow-x","hidden"),P(l,"class","svelte-l9tbzz"),h(s,"width","300px"),h(s,"box-sizing","border-box"),P(s,"placeholder","Type message here..."),P(s,"class","svelte-l9tbzz"),h(f,"color","grey"),P(f,"class","svelte-l9tbzz"),h(i,"display","flex"),h(i,"margin-top","5px"),h(i,"align-items","center"),h(i,"flex-wrap","nowrap"),P(i,"class","svelte-l9tbzz"),h(_,"margin-top","12px"),h(_,"height","30px"),h(_,"width","300px"),P(_,"class","svelte-l9tbzz"),h(e,"width","300px"),P(e,"class","svelte-l9tbzz")},m(I,u){z(I,e,u),d(e,l),g&&g.m(l,null),d(e,t),d(e,s),se(s,n[4]),n[12](s),d(e,o),d(e,i),d(i,f),d(f,a),d(i,r);for(let m=0;m<D.length;m+=1)D[m].m(i,null);d(e,p),d(e,_),d(_,U),b||(E=[B(s,"input",n[11]),B(_,"click",n[7])],b=!0)},p(I,[u]){if(I[5].messages?g?g.p(I,u):(g=Ne(I),g.c(),g.m(l,null)):g&&(g.d(1),g=null),u&16&&s.value!==I[4]&&se(s,I[4]),u&66){v=I[6];let m;for(m=0;m<v.length;m+=1){const T=Ie(I,v,m);D[m]?D[m].p(T,u):(D[m]=Re(T),D[m].c(),D[m].m(i,null))}for(;m<D.length;m+=1)D[m].d(1);D.length=v.length}},i:S,o:S,d(I){I&&c(e),g&&g.d(),n[12](null),ie(D,I),b=!1,oe(E)}}}function dt(n,e){if(e||(e=100),n){var l=document.createElement("input");l.style.position="absolute",l.style.top=n.offsetTop+7+"px",l.style.left=n.offsetLeft+"px",l.style.height=0,l.style.opacity=0,document.body.appendChild(l),l.focus(),setTimeout(function(){n.focus(),n.click(),document.body.removeChild(l)},e)}}function ht(n,e,l){let{friendUID:t}=e,{chatRoomID:s}=e,{currentUser:o}=e;const i=et(),f=tt(i,"sendTextMessage");let a,r,p,_=["now","today","any time"],U="any time",b={messages:[]};lt(()=>{je(G(j,"chats",s),async u=>{if(console.log("Current data: ",u.data()),u.data()){l(5,b=u.data());const m=G(j,"users",o.uid);$(m,{friendUIDsWithNewMessages:he(s)}),await st(),dt(a,300),r.scrollIntoView({block:"center",behavior:"smooth"})}})});async function E(){const u=G(j,"chats",s);$(u,{messages:ce({content:p,timestamp:Date.now(),authorUID:o.uid})});const m=G(j,"users",t);$(m,{friendUIDsWithNewMessages:ce(o.uid)});const T=await Je(m);switch(U){case"any time":break;case"now":console.log("sending text to ,",T.data().phoneNumber),f({content:`${o.name} wrote "${p}"`,toWho:T.data().phoneNumber})}l(4,p="")}function g(u){ye[u?"unshift":"push"](()=>{r=u,l(3,r)})}function v(){p=this.value,l(4,p)}function D(u){ye[u?"unshift":"push"](()=>{a=u,l(2,a)})}const I=u=>l(1,U=u);return n.$$set=u=>{"friendUID"in u&&l(8,t=u.friendUID),"chatRoomID"in u&&l(9,s=u.chatRoomID),"currentUser"in u&&l(0,o=u.currentUser)},n.$$.update=()=>{n.$$.dirty&2&&console.log("reply within =",U)},[o,U,a,r,p,b,_,E,t,s,g,v,D,I]}class _t extends He{constructor(e){super();Ze(this,e,ht,ct,me,{friendUID:8,chatRoomID:9,currentUser:0})}}function Te(n,e,l){const t=n.slice();return t[34]=e[l],t}function Ve(n,e,l){const t=n.slice();return t[37]=e[l],t}function Me(n,e,l){const t=n.slice();return t[40]=e[l],t}function Ce(n,e,l){const t=n.slice();return t[43]=e[l],t}function pt(n){let e,l,t,s,o,i,f,a,r,p,_,U,b,E,g,v,D,I,u,m=n[2].peopleCategories instanceof Array&&qe(n),T=n[8]&&Oe(n),A=n[2].messageRequestNames instanceof Array&&Be(n);return{c(){e=y("div"),m&&m.c(),l=q(),t=y("h2"),s=V("Editable category"),o=q(),i=y("button"),f=V("New category"),a=q(),r=y("input"),p=q(),_=y("button"),U=V("Add person"),b=q(),T&&T.c(),E=q(),g=y("h2"),v=V("Outside Messages"),D=q(),A&&A.c(),this.h()},l(C){e=k(C,"DIV",{style:!0});var R=w(e);m&&m.l(R),l=F(R),t=k(R,"H2",{class:!0,style:!0});var Z=w(t);s=M(Z,"Editable category"),Z.forEach(c),o=F(R),i=k(R,"BUTTON",{});var K=w(i);f=M(K,"New category"),K.forEach(c),a=F(R),r=k(R,"INPUT",{style:!0}),p=F(R),_=k(R,"BUTTON",{style:!0});var W=w(_);U=M(W,"Add person"),W.forEach(c),b=F(R),T&&T.l(R),E=F(R),g=k(R,"H2",{class:!0,style:!0});var L=w(g);v=M(L,"Outside Messages"),L.forEach(c),D=F(R),A&&A.l(R),R.forEach(c),this.h()},h(){P(t,"class","message-group-title svelte-aliv1u"),h(t,"margin-top","50px"),h(r,"width","90px"),h(_,"margin-top","20px"),P(g,"class","message-group-title svelte-aliv1u"),h(g,"margin-top","50px"),h(e,"width","100px")},m(C,R){z(C,e,R),m&&m.m(e,null),d(e,l),d(e,t),d(t,s),d(e,o),d(e,i),d(i,f),d(e,a),d(e,r),se(r,n[6]),d(e,p),d(e,_),d(_,U),d(e,b),T&&T.m(e,null),d(e,E),d(e,g),d(g,v),d(e,D),A&&A.m(e,null),I||(u=[B(i,"click",n[15]),B(r,"input",n[21]),B(_,"click",n[22])],I=!0)},p(C,R){C[2].peopleCategories instanceof Array?m?m.p(C,R):(m=qe(C),m.c(),m.m(e,l)):m&&(m.d(1),m=null),R[0]&64&&r.value!==C[6]&&se(r,C[6]),C[8]?T?T.p(C,R):(T=Oe(C),T.c(),T.m(e,E)):T&&(T.d(1),T=null),C[2].messageRequestNames instanceof Array?A?A.p(C,R):(A=Be(C),A.c(),A.m(e,null)):A&&(A.d(1),A=null)},i:S,o:S,d(C){C&&c(e),m&&m.d(),T&&T.d(),A&&A.d(),I=!1,oe(u)}}}function mt(n){let e,l,t,s,o,i,f,a,r,p,_,U,b,E,g,v,D,I,u,m,T,A,C,R,Z,K;return Z=new at({props:{canTakeInternationalNumbers:!0}}),{c(){e=y("div"),l=y("h4"),t=V("Zen Messenger"),s=q(),o=y("ul"),i=y("li"),f=y("b"),a=V("Fewer notifications:"),r=V(" messages won't ping you unless it requires immediate attention"),p=q(),_=y("li"),U=y("b"),b=V("Message summaries:"),E=V(" notifications are batched at regular times "),g=y("i"),v=V("and"),D=V(" before message deadlines"),I=q(),u=y("li"),m=y("b"),T=V("Fixed contact:"),A=V(" left-side panes are arranged by you, not by who messaged you most recently"),C=q(),R=y("div"),Ge(Z.$$.fragment),this.h()},l(W){e=k(W,"DIV",{style:!0});var L=w(e);l=k(L,"H4",{style:!0});var re=w(l);t=M(re,"Zen Messenger"),re.forEach(c),s=F(L),o=k(L,"UL",{style:!0});var X=w(o);i=k(X,"LI",{});var ne=w(i);f=k(ne,"B",{});var ae=w(f);a=M(ae,"Fewer notifications:"),ae.forEach(c),r=M(ne," messages won't ping you unless it requires immediate attention"),ne.forEach(c),p=F(X),_=k(X,"LI",{});var N=w(_);U=k(N,"B",{});var O=w(U);b=M(O,"Message summaries:"),O.forEach(c),E=M(N," notifications are batched at regular times "),g=k(N,"I",{});var Q=w(g);v=M(Q,"and"),Q.forEach(c),D=M(N," before message deadlines"),N.forEach(c),I=F(X),u=k(X,"LI",{});var H=w(u);m=k(H,"B",{});var te=w(m);T=M(te,"Fixed contact:"),te.forEach(c),A=M(H," left-side panes are arranged by you, not by who messaged you most recently"),H.forEach(c),X.forEach(c),L.forEach(c),C=F(W),R=k(W,"DIV",{style:!0});var fe=w(R);Ke(Z.$$.fragment,fe),fe.forEach(c),this.h()},h(){h(l,"margin-left","12px"),h(o,"padding-left","12px"),h(o,"font-size","0.8rem"),h(o,"list-style","none"),h(e,"font-family","Roboto, sans-serif"),h(e,"font-size","1.5rem"),h(e,"color","grey"),h(e,"margin-top","20px"),h(R,"width","350px")},m(W,L){z(W,e,L),d(e,l),d(l,t),d(e,s),d(e,o),d(o,i),d(i,f),d(f,a),d(i,r),d(o,p),d(o,_),d(_,U),d(U,b),d(_,E),d(_,g),d(g,v),d(_,D),d(o,I),d(o,u),d(u,m),d(m,T),d(u,A),z(W,C,L),z(W,R,L),Qe(Z,R,null),K=!0},p:S,i(W){K||(ee(Z.$$.fragment,W),K=!0)},o(W){x(Z.$$.fragment,W),K=!1},d(W){W&&c(e),W&&c(C),W&&c(R),Ye(Z)}}}function gt(n){let e,l;return{c(){e=y("div"),l=V("Fetching your data..."),this.h()},l(t){e=k(t,"DIV",{style:!0});var s=w(e);l=M(s,"Fetching your data..."),s.forEach(c),this.h()},h(){h(e,"margin-left","4px")},m(t,s){z(t,e,s),d(e,l)},p:S,i:S,o:S,d(t){t&&c(e)}}}function qe(n){let e,l=n[2].peopleCategories,t=[];for(let s=0;s<l.length;s+=1)t[s]=Ae(Me(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=J()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=J()},m(s,o){for(let i=0;i<t.length;i+=1)t[i].m(s,o);z(s,e,o)},p(s,o){if(o[0]&65670){l=s[2].peopleCategories;let i;for(i=0;i<l.length;i+=1){const f=Me(s,l,i);t[i]?t[i].p(f,o):(t[i]=Ae(f),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){ie(t,s),s&&c(e)}}}function Fe(n){let e,l,t=n[43].name+"",s,o,i;function f(){return n[18](n[43])}function a(...r){return n[19](n[43],...r)}return{c(){e=y("div"),l=y("span"),s=V(t),this.h()},l(r){e=k(r,"DIV",{draggable:!0,style:!0,class:!0});var p=w(e);l=k(p,"SPAN",{style:!0,class:!0});var _=w(l);s=M(_,t),_.forEach(c),p.forEach(c),this.h()},h(){h(l,"margin-left","5px"),P(l,"class","svelte-aliv1u"),P(e,"draggable","true"),h(e,"border","solid orange"),h(e,"height","40px"),h(e,"display","flex"),h(e,"align-items","center"),P(e,"class","svelte-aliv1u"),le(e,"highlighted-box",n[43].uid===n[1]),le(e,"highlighted-blue",n[7].includes(n[43].uid))},m(r,p){z(r,e,p),d(e,l),d(l,s),o||(i=[B(e,"click",f),B(e,"dragstart",a)],o=!0)},p(r,p){n=r,p[0]&4&&t!==(t=n[43].name+"")&&Y(s,t),p[0]&6&&le(e,"highlighted-box",n[43].uid===n[1]),p[0]&132&&le(e,"highlighted-blue",n[7].includes(n[43].uid))},d(r){r&&c(e),o=!1,oe(i)}}}function Ae(n){let e,l,t=n[40]+"",s,o,i,f,a;function r(...b){return n[17](n[40],...b)}let p=n[2].friends.filter(r),_=[];for(let b=0;b<p.length;b+=1)_[b]=Fe(Ce(n,p,b));function U(...b){return n[20](n[40],...b)}return{c(){e=y("div"),l=y("h2"),s=V(t),o=q();for(let b=0;b<_.length;b+=1)_[b].c();i=q(),this.h()},l(b){e=k(b,"DIV",{});var E=w(e);l=k(E,"H2",{class:!0});var g=w(l);s=M(g,t),g.forEach(c),o=F(E);for(let v=0;v<_.length;v+=1)_[v].l(E);i=F(E),E.forEach(c),this.h()},h(){P(l,"class","message-group-title svelte-aliv1u")},m(b,E){z(b,e,E),d(e,l),d(l,s),d(e,o);for(let g=0;g<_.length;g+=1)_[g].m(e,null);d(e,i),f||(a=[B(e,"drop",U),B(e,"dragover",Dt)],f=!0)},p(b,E){if(n=b,E[0]&4&&t!==(t=n[40]+"")&&Y(s,t),E[0]&134){p=n[2].friends.filter(r);let g;for(g=0;g<p.length;g+=1){const v=Ce(n,p,g);_[g]?_[g].p(v,E):(_[g]=Fe(v),_[g].c(),_[g].m(e,i))}for(;g<_.length;g+=1)_[g].d(1);_.length=p.length}},d(b){b&&c(e),ie(_,b),f=!1,oe(a)}}}function Oe(n){let e,l,t,s,o=n[10],i=[];for(let f=0;f<o.length;f+=1)i[f]=We(Ve(n,o,f));return{c(){e=y("div"),l=V("Here are all accounts:"),t=q();for(let f=0;f<i.length;f+=1)i[f].c();s=J()},l(f){e=k(f,"DIV",{});var a=w(e);l=M(a,"Here are all accounts:"),a.forEach(c),t=F(f);for(let r=0;r<i.length;r+=1)i[r].l(f);s=J()},m(f,a){z(f,e,a),d(e,l),z(f,t,a);for(let r=0;r<i.length;r+=1)i[r].m(f,a);z(f,s,a)},p(f,a){if(a[0]&3076){o=f[10];let r;for(r=0;r<o.length;r+=1){const p=Ve(f,o,r);i[r]?i[r].p(p,a):(i[r]=We(p),i[r].c(),i[r].m(s.parentNode,s))}for(;r<i.length;r+=1)i[r].d(1);i.length=o.length}},d(f){f&&c(e),f&&c(t),ie(i,f),f&&c(s)}}}function Pe(n){let e,l,t=n[37].name+"",s,o,i,f;function a(){return n[23](n[37])}return{c(){e=y("div"),l=y("button"),s=V(t),o=q(),this.h()},l(r){e=k(r,"DIV",{style:!0});var p=w(e);l=k(p,"BUTTON",{style:!0});var _=w(l);s=M(_,t),_.forEach(c),o=F(p),p.forEach(c),this.h()},h(){h(l,"margin-left","20px"),h(e,"margin-top","10px")},m(r,p){z(r,e,p),d(e,l),d(l,s),d(e,o),i||(f=B(l,"click",a),i=!0)},p(r,p){n=r},d(r){r&&c(e),i=!1,f()}}}function We(n){let e,l=n[37].uid!==n[2].uid&&Pe(n);return{c(){l&&l.c(),e=J()},l(t){l&&l.l(t),e=J()},m(t,s){l&&l.m(t,s),z(t,e,s)},p(t,s){t[37].uid!==t[2].uid?l?l.p(t,s):(l=Pe(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){l&&l.d(t),t&&c(e)}}}function Be(n){let e,l=n[2].messageRequestNames,t=[];for(let s=0;s<l.length;s+=1)t[s]=Se(Te(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=J()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=J()},m(s,o){for(let i=0;i<t.length;i+=1)t[i].m(s,o);z(s,e,o)},p(s,o){if(o[0]&8196){l=s[2].messageRequestNames;let i;for(i=0;i<l.length;i+=1){const f=Te(s,l,i);t[i]?t[i].p(f,o):(t[i]=Se(f),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){ie(t,s),s&&c(e)}}}function Se(n){let e,l=n[34]+"",t,s,o,i;function f(){return n[24](n[34])}return{c(){e=y("div"),t=V(l),s=q(),this.h()},l(a){e=k(a,"DIV",{style:!0});var r=w(e);t=M(r,l),s=F(r),r.forEach(c),this.h()},h(){h(e,"border","solid blue"),h(e,"height","40px"),h(e,"display","flex"),h(e,"align-items","center")},m(a,r){z(a,e,r),d(e,t),d(e,s),o||(i=B(e,"click",f),o=!0)},p(a,r){n=a,r[0]&4&&l!==(l=n[34]+"")&&Y(t,l)},d(a){a&&c(e),o=!1,i()}}}function vt(n){let e,l,t,s,o,i,f,a,r,p,_,U,b,E=n[2].uid+"",g,v,D,I;return{c(){e=y("div"),l=V("Click any chat on the left-side"),t=q(),s=y("input"),o=q(),i=y("button"),f=V("Update name"),a=q(),r=y("div"),p=V("Give this link to close friends & family so they can message you without a zen-message account:"),_=q(),U=y("a"),b=V("zen-message.com/"),g=V(E),this.h()},l(u){e=k(u,"DIV",{style:!0});var m=w(e);l=M(m,"Click any chat on the left-side"),m.forEach(c),t=F(u),s=k(u,"INPUT",{placeholder:!0}),o=F(u),i=k(u,"BUTTON",{});var T=w(i);f=M(T,"Update name"),T.forEach(c),a=F(u),r=k(u,"DIV",{style:!0});var A=w(r);p=M(A,"Give this link to close friends & family so they can message you without a zen-message account:"),A.forEach(c),_=F(u),U=k(u,"A",{style:!0,href:!0,target:!0});var C=w(U);b=M(C,"zen-message.com/"),g=M(C,E),C.forEach(c),this.h()},h(){h(e,"margin-top","5px"),h(e,"margin-bottom","12px"),P(s,"placeholder","John Apple"),h(r,"margin-top","10px"),h(U,"font-size","0.8rem"),h(U,"color","blue"),P(U,"href",v="https://zen-message.com/"+n[2].uid),P(U,"target","_blank")},m(u,m){z(u,e,m),d(e,l),z(u,t,m),z(u,s,m),se(s,n[3]),z(u,o,m),z(u,i,m),d(i,f),z(u,a,m),z(u,r,m),d(r,p),z(u,_,m),z(u,U,m),d(U,b),d(U,g),D||(I=[B(s,"input",n[26]),B(i,"click",n[12])],D=!0)},p(u,m){m[0]&8&&s.value!==u[3]&&se(s,u[3]),m[0]&4&&E!==(E=u[2].uid+"")&&Y(g,E),m[0]&4&&v!==(v="https://zen-message.com/"+u[2].uid)&&P(U,"href",v)},i:S,o:S,d(u){u&&c(e),u&&c(t),u&&c(s),u&&c(o),u&&c(i),u&&c(a),u&&c(r),u&&c(_),u&&c(U),D=!1,oe(I)}}}function bt(n){let e,l,t,s,o,i,f;return{c(){e=y("div"),l=V(n[4]),t=q(),s=y("button"),o=V("Resolve and delete")},l(a){e=k(a,"DIV",{});var r=w(e);l=M(r,n[4]),r.forEach(c),t=F(a),s=k(a,"BUTTON",{});var p=w(s);o=M(p,"Resolve and delete"),p.forEach(c)},m(a,r){z(a,e,r),d(e,l),z(a,t,r),z(a,s,r),d(s,o),i||(f=B(s,"click",n[25]),i=!0)},p(a,r){r[0]&16&&Y(l,a[4])},i:S,o:S,d(a){a&&c(e),a&&c(t),a&&c(s),i=!1,f()}}}function yt(n){let e=n[1],l,t,s=Le(n);return{c(){s.c(),l=J()},l(o){s.l(o),l=J()},m(o,i){s.m(o,i),z(o,l,i),t=!0},p(o,i){i[0]&2&&me(e,e=o[1])?(pe(),x(s,1,1,S),_e(),s=Le(o),s.c(),ee(s),s.m(l.parentNode,l)):s.p(o,i)},i(o){t||(ee(s),t=!0)},o(o){x(s),t=!1},d(o){o&&c(l),s.d(o)}}}function Le(n){let e,l;return e=new _t({props:{chatRoomID:n[0],friendUID:n[1],otherPersonUID:n[1],currentUser:n[2]}}),{c(){Ge(e.$$.fragment)},l(t){Ke(e.$$.fragment,t)},m(t,s){Qe(e,t,s),l=!0},p(t,s){const o={};s[0]&1&&(o.chatRoomID=t[0]),s[0]&2&&(o.friendUID=t[1]),s[0]&2&&(o.otherPersonUID=t[1]),s[0]&4&&(o.currentUser=t[2]),e.$set(o)},i(t){l||(ee(e.$$.fragment,t),l=!0)},o(t){x(e.$$.fragment,t),l=!1},d(t){Ye(e,t)}}}function kt(n){let e,l,t,s,o,i,f,a,r;const p=[gt,mt,pt],_=[];function U(v,D){return v[9]?v[9]&&!v[2]?1:2:0}t=U(n),s=_[t]=p[t](n);const b=[yt,bt,vt],E=[];function g(v,D){return v[1]&&v[2]&&v[0]?0:v[5]?1:v[2]?2:-1}return~(f=g(n))&&(a=E[f]=b[f](n)),{c(){e=y("div"),l=y("div"),s.c(),o=q(),i=y("div"),a&&a.c(),this.h()},l(v){e=k(v,"DIV",{style:!0});var D=w(e);l=k(D,"DIV",{});var I=w(l);s.l(I),I.forEach(c),o=F(D),i=k(D,"DIV",{style:!0});var u=w(i);a&&a.l(u),u.forEach(c),D.forEach(c),this.h()},h(){h(i,"width","320px"),h(i,"margin-left","5px"),h(i,"margin-top","5px"),h(e,"display","flex"),h(e,"padding-left","0px"),h(e,"padding-right","0px")},m(v,D){z(v,e,D),d(e,l),_[t].m(l,null),d(e,o),d(e,i),~f&&E[f].m(i,null),r=!0},p(v,D){let I=t;t=U(v),t===I?_[t].p(v,D):(pe(),x(_[I],1,1,()=>{_[I]=null}),_e(),s=_[t],s?s.p(v,D):(s=_[t]=p[t](v),s.c()),ee(s,1),s.m(l,null));let u=f;f=g(v),f===u?~f&&E[f].p(v,D):(a&&(pe(),x(E[u],1,1,()=>{E[u]=null}),_e()),~f?(a=E[f],a?a.p(v,D):(a=E[f]=b[f](v),a.c()),ee(a,1),a.m(i,null)):a=null)},i(v){r||(ee(s),ee(a),r=!0)},o(v){x(s),x(a),r=!1},d(v){v&&c(e),_[t].d(),~f&&E[f].d()}}}function Dt(n){n.preventDefault(),n.dataTransfer.dropEffect="move"}function wt(n,e){n.dataTransfer.setData("text/plain",e)}function It(n,e,l){let t,s;ke(n,ue,N=>l(2,t=N)),ke(n,we,N=>l(9,s=N));let o="",i="",f=null,a="",r="",p="",_=[];const U=it();let b="",E=[],g=!1;const v=nt(j,"users");ot(v).then(N=>{N.docs.forEach(O=>{E.push(be({uid:O.id},O.data()))})});async function D({name:N,uid:O}){for(const fe of t.friends)if(fe.uid===O){alert("You're already friends"),l(8,g=!1);return}const Q=G(j,"users",t.uid);await $(Q,{friends:ce({name:N,uid:O,category:t.peopleCategories[0]})});const H=t.uid<O?t.uid+O:O+t.uid,te=G(j,"chats",H);await De(te,{participantUIDs:[O,t.uid],messages:[]}),l(8,g=!1)}rt(U,async N=>{if(N){const O=G(j,"users",N.uid),Q=await Je(O);if(Q.exists())ue.set(Q.data());else{const H={uid:N.uid,name:N.displayName||"John Apple",phoneNumber:N.phoneNumber,friends:[],peopleCategories:["Friends","Family"],friendUIDsWithNewMessages:[]};await De(G(j,"users",N.uid),H),ue.set(H)}je(G(j,"users",N.uid),H=>{ue.set(H.data()),t.friendUIDsWithNewMessages&&l(7,_=t.friendUIDsWithNewMessages)})}we.set(!0)});async function I(){await $(G(j,"users",t.uid),{name:o}),l(3,o=""),alert("successfully updated")}function u(N){l(1,b=""),l(5,r=N),l(4,a=t.messageRequestObjects.filter(O=>O.senderName===N)[0].content)}function m(N){$(f,{messageRequestObjects:he({content:a,senderName:r}),messageRequestNames:he(r)}),l(5,r=""),l(4,a="")}function T(){p||alert("New category can't be blank"),$(f,{peopleCategories:ce(p)}),console.log("created new category"),l(6,p="")}async function A(N,O){N.preventDefault();const Q=N.dataTransfer.getData("text/plain"),H=[...t.friends];for(const te of H)if(te.uid===Q){te.category=O;break}await $(f,{friends:H})}const C=(N,O)=>O.category===N,R=N=>l(1,b=N.uid),Z=(N,O)=>wt(O,N.uid),K=(N,O)=>A(O,N);function W(){p=this.value,l(6,p)}const L=()=>l(8,g=!g),re=N=>D(N),X=N=>u(N),ne=()=>m();function ae(){o=this.value,l(3,o)}return n.$$.update=()=>{n.$$.dirty[0]&7&&b&&(l(0,i=t.uid<b?t.uid+b:b+t.uid),console.log("chatRoomID =",i)),n.$$.dirty[0]&4&&t&&(f=G(j,"users",t.uid))},[i,b,t,o,a,r,p,_,g,s,E,D,I,u,m,T,A,C,R,Z,K,W,L,re,X,ne,ae]}class Rt extends He{constructor(e){super();Ze(this,e,It,kt,me,{},null,[-1,-1])}}export{Rt as default};
